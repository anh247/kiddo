{%- if section.settings.hidden %}{% break %}{% endif -%}
{%- liquid
    assign currently = product.selected_or_first_available_variant
    assign image = currently.featured_image | default: product.featured_image
    assign pr_variants = product.variants
    assign available_v = pr_variants | where: "available"
    assign available_v_1 = available_v.first
    assign cur_var_id = currently.id
    assign pid = product.id
    assign hd_up = 'group-' | append: pid
    assign nav_up = linklists[hd_up].links | where: 'type', 'product_link'
    assign nav_up_size = nav_up.size
    assign variants_size = pr_variants.size
    assign selected_variant = product.selected_variant
-%}

<div class="js_sticky_atc_wrapper sticky_atc_wrapper" data-js-product>
    <script class="data-json-product" type="application/json">{% render 'product-get-attributes', product: product, build_variant: 'json' %}</script>
    <div class="container">
        <div class="sticky_atc_inner">
            <div class="sticky_atc_thumb" data-js-product-image>
                {%- assign img_url = image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
                <img data-image-lazy alt="{{ product.title | escape }}" data-src="{{ img_url }}" data-widths="[75, 150]" data-sizes="auto" class="js_fgr_img pr_lazy_img lazyload " src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
            </div>
            <div class="sticky_atc_info">
                <h2 class="product-title">{{ product.title }}</h2>
                {% render 'product-get-price-single', product: product %}
            </div>
            {%- form 'product', product, id: product_form_id, class: 'form', novalidate: 'novalidate', data-type: 'add-to-cart-form' -%}
                <div class="sticky_atc_btn variations_form">
                    {%- if available_v.size < 2 -%}
                        <input class="js_sticky_sl" name="id" value="{{ available_v_1.id }}" type="hidden">
                    {%- else -%}
                        <div class="wrap_variant hidden">
                            <span class="popup_variant"><i class="main-icon-sliders"></i></span>
                            {% render 'product-get-options', product: product %}
                        </div>
                        <div class="select-sticky">
                            <select name="id" class="js_sticky_sl" data-select-sticky_atc>
                                {%- for variant in available_v -%}
                                    <option data-img="{{ variant.image | default: product.featured_image | img_url: '1x1' }}"
                                            data-ogprice="{{ variant.compare_at_price | default: variant.price }}"
                                            data-price="{{ variant.price }}"
                                            value="{{ variant.id }}"{% if variant.id == cur_var_id %} selected="selected"{% endif %}>{{ variant.title | escape }}</option>
                                {%- endfor -%}
                            </select>
                        </div>
                    {% endif %}
                    {%- if nav_up_size == 0 -%}
                        {% render 'product-get-quantity', product: product %}
                    {%- endif -%}
                    <button data-js-product-button-add-to-cart
                            class="single_add_to_cart_button js_add_to_cart_button {% if nav_up_size > 0 %}sticky_atc_a{% else %}sticky_atc_js{% endif %}{% if settings.pr_curent == '1' and variants_size > 1 and selected_variant == blank %} disabled{% endif %}"
                            data-pid="{{ product.variants.first.id }}">
                        <span class="circle-loading"></span>
                        <span class="text">{{ 'products.product.add_to_cart' | t }}</span>
                        <span class="txt_out_stock d-none">{{ 'products.product.out_stock' | t }}</span>
                    </button>
                </div>
            {% endform %}
        </div>
    </div>
</div>

{%- schema -%}
{
    "name": "Sticky Add to cart",
    "settings": [
        {
            "type": "checkbox",
            "id": "hidden",
            "label": "Hide Section"
        }
    ]
}
{% endschema %}